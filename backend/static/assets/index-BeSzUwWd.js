var B=Object.defineProperty;var X=(i,t,e)=>t in i?B(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var E=(i,t,e)=>X(i,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function e(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=e(r);fetch(r.href,s)}})();class Q{constructor(){this._events={}}on(t,e,n={}){this._events[t]=this._events[t]||[],this._events[t].push({fn:e,options:n})}off(t,e){const n=this._events[t]||[];this._events[t]=n.filter(r=>r.fn!==e)}find(t){return this._events[t]}run(t,...e){const n=this.getSubscribers(t,this._events);return console.assert(n&&n.length>0,"No subscriber for event: "+t),n.forEach(r=>{const{fn:s,options:o}=r;return o.delay?this.delay(t,s,e,o):Object.keys(o).length>0?s.apply(this,[...e,o]):s.apply(this,e),!r.options.once}),n.length}once(t,e,n={}){this.on(t,e,Object.assign(Object.assign({},n),{once:!0}))}delay(t,e,n,r){r._t&&clearTimeout(r._t),r._t=setTimeout(()=>{clearTimeout(r._t),Object.keys(r).length>0?e.apply(this,[...n,r]):e.apply(this,n)},r.delay)}runAsync(t,...e){const n=this.getSubscribers(t,this._events);console.assert(n&&n.length>0,"No subscriber for event: "+t);const r=n.map(s=>{const{fn:o,options:c}=s;return Object.keys(c).length>0?o.apply(this,[...e,c]):o.apply(this,e)});return Promise.all(r)}query(t,...e){return this.runAsync(t,...e)}getSubscribers(t,e){const n=e[t]||[];return e[t]=n.filter(r=>!r.options.once),Object.keys(e).filter(r=>r.endsWith("*")&&t.startsWith(r.replace("*",""))).sort((r,s)=>s.length-r.length).forEach(r=>n.push(...e[r].map(s=>Object.assign(Object.assign({},s),{options:Object.assign(Object.assign({},s.options),{event:t})})))),n}}const K="AppRun-3";let A;const _=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global;_.app&&_._AppRunVersions?A=_.app:(A=new Q,_.app=A,_._AppRunVersions=K);const a=A,g=(i,t)=>(t?i.state[t]:i.state)||"",b=(i,t,e)=>{if(t){const n=i.state||{};n[t]=e,i.setState(n)}else i.setState(e)},J=(i,t,e,n)=>{if(i.startsWith("$on")){const r=t[i];if(i=i.substring(1),typeof r=="boolean")t[i]=s=>n.run?n.run(i,s):a.run(i,s);else if(typeof r=="string")t[i]=s=>n.run?n.run(r,s):a.run(r,s);else if(typeof r=="function")t[i]=s=>n.setState(r(n.state,s));else if(Array.isArray(r)){const[s,...o]=r;typeof s=="string"?t[i]=c=>n.run?n.run(s,...o,c):a.run(s,...o,c):typeof s=="function"&&(t[i]=c=>n.setState(s(n.state,...o,c)))}}else if(i==="$bind"){const r=t.type||"text",s=typeof t[i]=="string"?t[i]:t.name;if(e==="input")switch(r){case"checkbox":t.checked=g(n,s),t.onclick=o=>b(n,s||o.target.name,o.target.checked);break;case"radio":t.checked=g(n,s)===t.value,t.onclick=o=>b(n,s||o.target.name,o.target.value);break;case"number":case"range":t.value=g(n,s),t.oninput=o=>b(n,s||o.target.name,Number(o.target.value));break;default:t.value=g(n,s),t.oninput=o=>b(n,s||o.target.name,o.target.value)}else e==="select"?(t.value=g(n,s),t.onchange=o=>{o.target.multiple||b(n,s||o.target.name,o.target.value)}):e==="option"?(t.selected=g(n,s),t.onclick=o=>b(n,s||o.target.name,o.target.selected)):e==="textarea"&&(t.innerHTML=g(n,s),t.oninput=o=>b(n,s||o.target.name,o.target.value))}else a.run("$",{key:i,tag:e,props:t,component:n})},S=(i,t)=>{if(Array.isArray(i))return i.map(e=>S(e,t));{let{type:e,tag:n,props:r,children:s}=i;return n=n||e,s=s||(r==null?void 0:r.children),r&&Object.keys(r).forEach(o=>{o.startsWith("$")&&(J(o,r,n,t),delete r[o])}),s&&S(s,t),i}};function z(i,...t){return G(t)}const W="_props";function G(i){const t=[],e=n=>{n!=null&&n!==""&&n!==!1&&t.push(typeof n=="function"||typeof n=="object"?n:`${n}`)};return i&&i.forEach(n=>{Array.isArray(n)?n.forEach(r=>e(r)):e(n)}),t}function Z(i,t,...e){const n=G(e);if(typeof i=="string")return{tag:i,props:t,children:n};if(Array.isArray(i))return i;if(i===void 0&&e)return n;if(Object.getPrototypeOf(i).__isAppRunComponent)return{tag:i,props:t,children:n};if(typeof i=="function")return i(t,n);throw new Error(`Unknown tag in vdom ${i}`)}const Y=new WeakMap,ee=(i,t,e={})=>{if(t==null||t===!1)return;const n=typeof i=="string"&&i?document.getElementById(i)||document.querySelector(i):i;t=S(t,e),te(n,t,e)};function te(i,t,e={}){if(t==null||t===!1||(t=C(t,e),!i))return;const n=i.nodeName==="SVG";Array.isArray(t)?D(i,t,n):D(i,[t],n)}function ne(i,t){const e=i.nodeName,n=`${t.tag||""}`;return e.toUpperCase()===n.toUpperCase()}function M(i,t,e){if(t._op!==3){if(e=e||t.tag==="svg",!ne(i,t)){i.parentNode.replaceChild(N(t,e),i);return}!(t._op&2)&&D(i,t.children,e),!(t._op&1)&&P(i,t.props,e)}}function D(i,t,e){var n,r;const s=((n=i.childNodes)===null||n===void 0?void 0:n.length)||0,o=(t==null?void 0:t.length)||0,c=Math.min(s,o);for(let l=0;l<c;l++){const u=t[l];if(u._op===3)continue;const f=i.childNodes[l];if(typeof u=="string")f.textContent!==u&&(f.nodeType===3?f.nodeValue=u:i.replaceChild(q(u),f));else if(u instanceof HTMLElement||u instanceof SVGElement)i.insertBefore(u,f);else{const m=u.props&&u.props.key;if(m)if(f.key===m)M(i.childNodes[l],u,e);else{const y=Y[m];if(y){const d=y.nextSibling;i.insertBefore(y,f),d?i.insertBefore(f,d):i.appendChild(f),M(i.childNodes[l],u,e)}else i.replaceChild(N(u,e),f)}else M(i.childNodes[l],u,e)}}let h=((r=i.childNodes)===null||r===void 0?void 0:r.length)||0;for(;h>c;)i.removeChild(i.lastChild),h--;if(o>c){const l=document.createDocumentFragment();for(let u=c;u<t.length;u++)l.appendChild(N(t[u],e));i.appendChild(l)}}const U=i=>{const t=document.createElement("section");return t.insertAdjacentHTML("afterbegin",i),Array.from(t.children)};function q(i){if((i==null?void 0:i.indexOf("_html:"))===0){const t=document.createElement("div");return t.insertAdjacentHTML("afterbegin",i.substring(6)),t}else return document.createTextNode(i??"")}function N(i,t){if(i instanceof HTMLElement||i instanceof SVGElement)return i;if(typeof i=="string")return q(i);if(!i.tag||typeof i.tag=="function")return q(JSON.stringify(i));t=t||i.tag==="svg";const e=t?document.createElementNS("http://www.w3.org/2000/svg",i.tag):document.createElement(i.tag);return P(e,i.props,t),i.children&&i.children.forEach(n=>e.appendChild(N(n,t))),e}function re(i,t){t.class=t.class||t.className,delete t.className;const e={};return i&&Object.keys(i).forEach(n=>e[n]=null),Object.keys(t).forEach(n=>e[n]=t[n]),e}function P(i,t,e){const n=i[W]||{};t=re(n,t||{}),i[W]=t;for(const r in t){const s=t[r];if(r.startsWith("data-")){const c=r.substring(5).replace(/-(\w)/g,h=>h[1].toUpperCase());i.dataset[c]!==s&&(s||s===""?i.dataset[c]=s:delete i.dataset[c])}else if(r==="style")if(i.style.cssText&&(i.style.cssText=""),typeof s=="string")i.style.cssText=s;else for(const o in s)i.style[o]!==s[o]&&(i.style[o]=s[o]);else if(r.startsWith("xlink")){const o=r.replace("xlink","").toLowerCase();s==null||s===!1?i.removeAttributeNS("http://www.w3.org/1999/xlink",o):i.setAttributeNS("http://www.w3.org/1999/xlink",o,s)}else r.startsWith("on")?!s||typeof s=="function"?i[r]=s:typeof s=="string"&&(s?i.setAttribute(r,s):i.removeAttribute(r)):/^id$|^class$|^list$|^readonly$|^contenteditable$|^role|-|^for$/g.test(r)||e?i.getAttribute(r)!==s&&(s?i.setAttribute(r,s):i.removeAttribute(r)):i[r]!==s&&(i[r]=s);r==="key"&&s&&(Y[s]=i)}t&&typeof t.ref=="function"&&window.requestAnimationFrame(()=>t.ref(i))}function ie(i,t,e){const{tag:n,props:r,children:s}=i;let o=`_${e}`,c=r&&r.id;c?o=c:c=`_${e}${Date.now()}`;let h="section";r&&r.as&&(h=r.as,delete r.as),t.__componentCache||(t.__componentCache={});let l=t.__componentCache[o];if(!l||!(l instanceof n)||!l.element){const u=document.createElement(h);l=t.__componentCache[o]=new n(Object.assign(Object.assign({},r),{children:s})).mount(u,{render:!0})}else l.renderState(l.state);if(l.mounted){const u=l.mounted(r,s,l.state);typeof u<"u"&&l.setState(u)}return P(l.element,r,!1),l.element}function C(i,t,e=0){var n;if(typeof i=="string")return i;if(Array.isArray(i))return i.map(s=>C(s,t,e++));let r=i;if(i&&typeof i.tag=="function"&&Object.getPrototypeOf(i.tag).__isAppRunComponent&&(r=ie(i,t,e)),r&&Array.isArray(r.children)){const s=(n=r.props)===null||n===void 0?void 0:n._component;if(s){let o=0;r.children=r.children.map(c=>C(c,s,o++))}else r.children=r.children.map(o=>C(o,t,e++))}return r}const ae=(i,t={})=>class extends HTMLElement{constructor(){super()}get component(){return this._component}get state(){return this._component.state}static get observedAttributes(){return(t.observedAttributes||[]).map(n=>n.toLowerCase())}connectedCallback(){if(this.isConnected&&!this._component){const n=t||{};this._shadowRoot=n.shadow?this.attachShadow({mode:"open"}):this;const r=n.observedAttributes||[],s=r.reduce((c,h)=>{const l=h.toLowerCase();return l!==h&&(c[l]=h),c},{});this._attrMap=c=>s[c]||c;const o={};Array.from(this.attributes).forEach(c=>o[this._attrMap(c.name)]=c.value),r.forEach(c=>{this[c]!==void 0&&(o[c]=this[c]),Object.defineProperty(this,c,{get(){return o[c]},set(h){this.attributeChangedCallback(c,o[c],h)},configurable:!0,enumerable:!0})}),requestAnimationFrame(()=>{const c=this.children?Array.from(this.children):[];if(this._component=new i(Object.assign(Object.assign({},o),{children:c})).mount(this._shadowRoot,n),this._component._props=o,this._component.dispatchEvent=this.dispatchEvent.bind(this),this._component.mounted){const h=this._component.mounted(o,c,this._component.state);typeof h<"u"&&(this._component.state=h)}this.on=this._component.on.bind(this._component),this.run=this._component.run.bind(this._component),n.render!==!1&&this._component.run(".")})}}disconnectedCallback(){var n,r,s,o;(r=(n=this._component)===null||n===void 0?void 0:n.unload)===null||r===void 0||r.call(n),(o=(s=this._component)===null||s===void 0?void 0:s.unmount)===null||o===void 0||o.call(s),this._component=null}attributeChangedCallback(n,r,s){if(this._component){const o=this._attrMap(n);this._component._props[o]=s,this._component.run("attributeChanged",o,r,s),s!==r&&t.render!==!1&&window.requestAnimationFrame(()=>{this._component.run(".")})}}},I=(i,t,e)=>{typeof customElements<"u"&&customElements.define(i,ae(t,e))},V={meta:new WeakMap,defineMetadata(i,t,e){this.meta.has(e)||this.meta.set(e,{}),this.meta.get(e)[i]=t},getMetadataKeys(i){return i=Object.getPrototypeOf(i),this.meta.get(i)?Object.keys(this.meta.get(i)):[]},getMetadata(i,t){return t=Object.getPrototypeOf(t),this.meta.get(t)?this.meta.get(t)[i]:null}};function se(i,t={}){return function(e,n){const r=i?i.toString():n;V.defineMetadata(`apprun-update:${r}`,{name:r,key:n,options:t},e)}}function oe(i,t){return function(n){return I(i,n,t),n}}const k=new Map;a.find("get-components")||a.on("get-components",i=>i.components=k);const F=i=>i;class T{renderState(t,e=null){if(!this.view)return;let n=e||this.view(t);if(a.debug&&a.run("debug",{component:this,_:n?".":"-",state:t,vdom:n,el:this.element}),typeof document!="object")return;const r=typeof this.element=="string"&&this.element?document.getElementById(this.element)||document.querySelector(this.element):this.element;if(!r)return;const s="_c";this.unload?(r._component!==this||r.getAttribute(s)!==this.tracking_id)&&(this.tracking_id=new Date().valueOf().toString(),r.setAttribute(s,this.tracking_id),typeof MutationObserver<"u"&&(this.observer||(this.observer=new MutationObserver(o=>{(o[0].oldValue===this.tracking_id||!document.body.contains(r))&&(this.unload(this.state),this.observer.disconnect(),this.observer=null)})),this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0,attributeFilter:[s]}))):r.removeAttribute&&r.removeAttribute(s),r._component=this,!e&&n&&(n=S(n,this),this.options.transition&&document&&document.startViewTransition?document.startViewTransition(()=>a.render(r,n,this)):a.render(r,n,this)),this.rendered&&this.rendered(this.state)}setState(t,e={render:!0,history:!1}){if(t instanceof Promise)Promise.resolve(t).then(n=>{this.setState(n,e),this._state=t});else{if(this._state=t,t==null)return;this.state=t,e.render!==!1&&(e.transition&&document&&document.startViewTransition?document.startViewTransition(()=>this.renderState(t)):this.renderState(t)),e.history!==!1&&this.enable_history&&(this._history=[...this._history,t],this._history_idx=this._history.length-1),typeof e.callback=="function"&&e.callback(this.state)}}constructor(t,e,n,r){this.state=t,this.view=e,this.update=n,this.options=r,this._app=new Q,this._actions=[],this._global_events=[],this._history=[],this._history_idx=-1,this._history_prev=()=>{this._history_idx--,this._history_idx>=0?this.setState(this._history[this._history_idx],{render:!0,history:!1}):this._history_idx=0},this._history_next=()=>{this._history_idx++,this._history_idx<this._history.length?this.setState(this._history[this._history_idx],{render:!0,history:!1}):this._history_idx=this._history.length-1},this.start=(s=null,o)=>{if(this.mount(s,Object.assign({render:!0},o)),this.mounted&&typeof this.mounted=="function"){const c=this.mounted({},[],this.state);typeof c<"u"&&this.setState(c)}return this}}mount(t=null,e){var n,r;return console.assert(!this.element,"Component already mounted."),this.options=e=Object.assign(Object.assign({},this.options),e),this.element=t,this.global_event=e.global_event,this.enable_history=!!e.history,this.enable_history&&(this.on(e.history.prev||"history-prev",this._history_prev),this.on(e.history.next||"history-next",this._history_next)),e.route&&(this.update=this.update||{},this.update[e.route]||(this.update[e.route]=F)),this.add_actions(),this.state=(r=(n=this.state)!==null&&n!==void 0?n:this.model)!==null&&r!==void 0?r:{},typeof this.state=="function"&&(this.state=this.state()),this.setState(this.state,{render:!!e.render,history:!0}),a.debug&&(k.get(t)?k.get(t).push(this):k.set(t,[this])),this}is_global_event(t){return t&&(this.global_event||this._global_events.indexOf(t)>=0||t.startsWith("#")||t.startsWith("/")||t.startsWith("@"))}add_action(t,e,n={}){!e||typeof e!="function"||(n.global&&this._global_events.push(t),this.on(t,(...r)=>{a.debug&&a.run("debug",{component:this,_:">",event:t,p:r,current_state:this.state,options:n});const s=e(this.state,...r);a.debug&&a.run("debug",{component:this,_:"<",event:t,p:r,newState:s,state:this.state,options:n}),this.setState(s,n)},n))}add_actions(){const t=this.update||{};V.getMetadataKeys(this).forEach(n=>{if(n.startsWith("apprun-update:")){const r=V.getMetadata(n,this);t[r.name]=[this[r.key].bind(this),r.options]}});const e={};Array.isArray(t)?t.forEach(n=>{const[r,s,o]=n;r.toString().split(",").forEach(h=>e[h.trim()]=[s,o])}):Object.keys(t).forEach(n=>{const r=t[n];(typeof r=="function"||Array.isArray(r))&&n.split(",").forEach(s=>e[s.trim()]=r)}),e["."]||(e["."]=F),Object.keys(e).forEach(n=>{const r=e[n];typeof r=="function"?this.add_action(n,r):Array.isArray(r)&&this.add_action(n,r[0],r[1])})}run(t,...e){if(this.state instanceof Promise)return Promise.resolve(this.state).then(n=>{this.state=n,this.run(t,...e)});{const n=t.toString();return this.is_global_event(n)?a.run(n,...e):this._app.run(n,...e)}}on(t,e,n){const r=t.toString();return this._actions.push({name:r,fn:e}),this.is_global_event(r)?a.on(r,e,n):this._app.on(r,e,n)}runAsync(t,...e){const n=t.toString();return this.is_global_event(n)?a.runAsync(n,...e):this._app.runAsync(n,...e)}query(t,...e){return this.runAsync(t,...e)}unmount(){var t;(t=this.observer)===null||t===void 0||t.disconnect(),this._actions.forEach(e=>{const{name:n,fn:r}=e;this.is_global_event(n)?a.off(n,r):this._app.off(n,r)})}}T.__isAppRunComponent=!0;const L="//",H="///",x=i=>{if(i||(i="#"),i.startsWith("#")){const[t,...e]=i.split("/");a.run(t,...e)||a.run(H,t,...e),a.run(L,t,...e)}else if(i.startsWith("/")){const[t,e,...n]=i.split("/");a.run("/"+e,...n)||a.run(H,"/"+e,...n),a.run(L,"/"+e,...n)}else a.run(i)||a.run(H,i),a.run(L,i)};if(!a.start){a.h=a.createElement=Z,a.render=ee,a.Fragment=z,a.webComponent=I,a.safeHTML=U,a.start=(t,e,n,r,s)=>{const o=Object.assign({render:!0,global_event:!0},s),c=new T(e,n,r);return s&&s.rendered&&(c.rendered=s.rendered),s&&s.mounted&&(c.mounted=s.mounted),c.start(t,o),c};const i=t=>{};a.on("$",i),a.on("debug",t=>i),a.on(L,i),a.on("#",i),a.route=x,a.on("route",t=>a.route&&a.route(t)),typeof document=="object"&&document.addEventListener("DOMContentLoaded",()=>{a.route===x&&(window.onpopstate=()=>x(location.hash),document.body.hasAttribute("apprun-no-init")||a["no-init-route"]||x(location.hash))}),typeof window=="object"&&(window.Component=T,window._React=window.React,window.React=a,window.on=se,window.customElement=oe,window.safeHTML=U),a.use_render=(t,e=0)=>e===0?a.render=(n,r)=>t(r,n):a.render=(n,r)=>t(n,r),a.use_react=(t,e)=>{a.h=a.createElement=t.createElement,a.Fragment=t.Fragment,a.render=(n,r)=>e.render(r,n),t.version&&t.version.startsWith("18")&&(a.render=(n,r)=>{!n||!r||(n._root||(n._root=e.createRoot(n)),n._root.render(r))})}}class le extends T{constructor(){super(...arguments);E(this,"state",{player:{name:"Adventurer",health:100,maxHealth:100,level:1,experience:0,experienceToLevel:100,gold:0,strength:5,dexterity:5,magic:5,stamina:100,maxStamina:100,statusEffects:[],combatAbilities:[{id:1,name:"Power Strike",description:"A powerful melee attack that deals extra damage",damageType:"physical",staminaCost:20,cooldown:5,baseDamage:15,requiredLevel:1,requiredStat:"strength",requiredStatValue:5},{id:2,name:"Quick Shot",description:"A fast ranged attack with a chance to hit twice",damageType:"ranged",staminaCost:15,cooldown:3,baseDamage:10,requiredLevel:1,requiredStat:"dexterity",requiredStatValue:5},{id:3,name:"Fireball",description:"A magical attack that deals fire damage over time",damageType:"magic",staminaCost:25,cooldown:8,baseDamage:20,statusEffect:'{"type": "burn", "damage": 5, "duration": 3}',requiredLevel:1,requiredStat:"magic",requiredStatValue:5}],skills:{combat:1,fishing:1,cooking:1,farming:1,crafting:1,alchemy:1},inventory:{weapons:["Wooden Sword"],armor:["Cloth Tunic"],consumables:["Health Potion"],materials:[]},activeQuests:[],completedQuests:[]},currentView:"main",inCombat:!1,combatLog:[],availableQuests:["Goblin Slayer","Wolf Hunter"],shopItems:["Iron Sword","Leather Armor"],craftingStations:[]});E(this,"view",e=>{var r,s,o,c,h;const n=e.currentView==="main"?a.h("div",{className:"main-menu"},a.h("button",{onclick:()=>a.run("navigate","combat")},"Combat"),a.h("button",{onclick:()=>a.run("navigate","crafting")},"Crafting"),a.h("button",{onclick:()=>a.run("navigate","quests")},"Quests"),a.h("button",{onclick:()=>a.run("navigate","inventory")},"Inventory"),a.h("button",{onclick:()=>a.run("navigate","skills")},"Skills"),a.h("button",{onclick:()=>a.run("navigate","shop")},"Shop")):e.currentView==="crafting"?a.h("div",{className:"crafting-view"},a.h("h2",null,"Crafting Stations"),a.h("div",{className:"stations-list"},e.craftingStations.map(l=>a.h("div",{key:l.id,className:"station-card"},a.h("h3",null,l.name),a.h("p",null,l.description),a.h("div",{className:"station-details"},a.h("span",null,"Type: ",l.type),a.h("span",null,"Location: ",l.location),a.h("span",null,"Required Skill: ",l.skillLevel)),a.h("button",{onclick:()=>a.run("useCraftingStation",l),disabled:e.player.skills.crafting<l.skillLevel},"Use Station")))),a.h("button",{onclick:()=>a.run("navigate","main")},"Return to Main Menu")):e.currentView==="combat"?a.h("div",{className:"combat-view"},e.inCombat?a.h("div",{className:"combat-interface"},a.h("div",{className:"enemy-info"},a.h("h3",null,(r=e.currentEnemy)==null?void 0:r.name),a.h("div",null,"Health: ",(s=e.currentEnemy)==null?void 0:s.health),a.h("div",null,"Level: ",(o=e.currentEnemy)==null?void 0:o.level),a.h("div",{className:"progress-bar"},a.h("div",{className:"progress",style:{width:`${(((c=e.currentEnemy)==null?void 0:c.health)||0)/(((h=e.currentEnemy)==null?void 0:h.maxHealth)||1)*100}%`}}))),a.h("div",{className:"player-info"},a.h("div",null,"Health: ",e.player.health,"/",e.player.maxHealth),a.h("div",null,"Level: ",e.player.level," (XP: ",e.player.experience,"/",e.player.experienceToLevel,")"),a.h("div",null,"Gold: ",e.player.gold),a.h("div",{className:"progress-bar health-bar"},a.h("div",{className:"progress",style:{width:`${e.player.health/e.player.maxHealth*100}%`}})),a.h("div",{className:"progress-bar xp-bar"},a.h("div",{className:"progress",style:{width:`${e.player.experience/e.player.experienceToLevel*100}%`}}))),a.h("div",{className:"status-effects"},e.player.statusEffects.map((l,u)=>a.h("div",{key:u,className:`status-effect ${l.type}`},l.type,a.h("span",{className:"status-effect-timer"},Math.ceil((new Date(l.endTime).getTime()-Date.now())/1e3),"s")))),a.h("div",{className:"abilities-list"},e.player.combatAbilities.map(l=>{const u=l.lastUsed&&(Date.now()-new Date(l.lastUsed).getTime())/1e3<l.cooldown,f=e.player.stamina<l.staminaCost,m=e.player[l.requiredStat]<l.requiredStatValue;return a.h("button",{key:l.id,className:"ability-button",onclick:()=>a.run("useAbility",l.id),disabled:u||f||m},l.name,a.h("div",{className:"ability-tooltip"},l.description,a.h("br",null),"Damage: ",l.baseDamage,a.h("br",null),"Cost: ",l.staminaCost," stamina",a.h("br",null),"Requires: ",l.requiredStat," ",l.requiredStatValue,u&&a.h("span",null,a.h("br",null),"Cooldown: ",Math.ceil(l.cooldown-(Date.now()-(l.lastUsed?l.lastUsed.getTime():Date.now()))/1e3),"s")))})),a.h("div",{className:"combat-actions"},a.h("button",{onclick:()=>a.run("attack")},"Basic Attack"),a.h("button",{onclick:()=>a.run("useItem","Health Potion"),disabled:!e.player.inventory.consumables.includes("Health Potion")},"Use Health Potion"),a.h("button",{onclick:()=>a.run("defend")},"Defend"),a.h("button",{onclick:()=>a.run("flee")},"Flee")),a.h("div",{className:"combat-log"},e.combatLog.map((l,u)=>a.h("div",{key:u,className:`log-entry ${l.includes("damage")?"damage-message":l.includes("Level Up")?"level-up-message":l.includes("defeated")?"victory-message":""}`},l)))):a.h("div",{className:"combat-menu"},a.h("h2",null,"Combat Arena"),a.h("button",{onclick:()=>a.run("startCombat","Goblin")},"Fight Goblin (Level 1)"),a.h("button",{onclick:()=>a.run("startCombat","Wolf")},"Fight Wolf (Level 2)"),a.h("button",{onclick:()=>a.run("startCombat","Orc")},"Fight Orc (Level 3)"),a.h("button",{onclick:()=>a.run("navigate","main")},"Return to Main Menu"))):e.currentView==="quests"?a.h("div",{className:"quests-view"},a.h("h2",null,"Quests"),a.h("div",{className:"active-quests"},a.h("h3",null,"Active Quests"),e.player.activeQuests.length>0?e.player.activeQuests.map((l,u)=>a.h("div",{key:u,className:"quest"},l)):a.h("div",null,"No active quests")),a.h("div",{className:"available-quests"},a.h("h3",null,"Available Quests"),e.availableQuests.map((l,u)=>a.h("div",{key:u,className:"quest"},l,a.h("button",{onclick:()=>a.run("acceptQuest",l)},"Accept")))),a.h("button",{onclick:()=>a.run("navigate","main")},"Return to Main Menu")):null;return a.h("div",{className:"game-container"},a.h("header",null,a.h("h1",null,"GalyCherryGame"),a.h("div",{className:"player-stats"},a.h("div",null,"Name: ",e.player.name),a.h("div",null,"Health: ",e.player.health,"/",e.player.maxHealth),a.h("div",null,"Level: ",e.player.level," (XP: ",e.player.experience,"/",e.player.experienceToLevel,")"),a.h("div",null,"Gold: ",e.player.gold))),a.h("main",null,n))});E(this,"update",{navigate:(e,n)=>({...e,currentView:n}),setCraftingStations:(e,n)=>({...e,craftingStations:n}),useCraftingStation:e=>e,startCombat:(e,n)=>({...e,inCombat:!0,currentEnemy:{Goblin:{name:"Goblin",health:50,maxHealth:50,level:1,maxDamage:5,defense:2,statusEffects:[]},Wolf:{name:"Wolf",health:75,maxHealth:75,level:2,maxDamage:8,defense:3,statusEffects:[]},Orc:{name:"Orc",health:100,maxHealth:100,level:3,maxDamage:12,defense:5,statusEffects:[]}}[n],combatLog:[`A wild ${n} appears!`]}),useAbility:(e,n)=>{if(!e.currentEnemy)return e;const r=e.player.combatAbilities.find(d=>d.id===n);if(!r||r.lastUsed&&(Date.now()-new Date(r.lastUsed).getTime())/1e3<r.cooldown||e.player.stamina<r.staminaCost||e.player[r.requiredStat]<r.requiredStatValue)return e;const s=[...e.combatLog];let o=0;switch(r.damageType){case"physical":o=e.player.strength*2;break;case"ranged":o=e.player.dexterity*2;break;case"magic":o=e.player.magic*2;break}const c=r.baseDamage+o,h=Math.max(0,e.currentEnemy.health-c);if(s.push(`You use ${r.name} and deal ${c} damage to ${e.currentEnemy.name}!`),r.statusEffect){const d=JSON.parse(r.statusEffect),p={type:d.type,damage:d.damage,duration:d.duration,endTime:new Date(Date.now()+d.duration*1e3)};e.currentEnemy.statusEffects.push(p),s.push(`${e.currentEnemy.name} is affected by ${d.type}!`)}const l=e.player.combatAbilities.map(d=>d.id===r.id?{...d,lastUsed:new Date}:d),u=e.player.stamina-r.staminaCost;if(h<=0){const d=e.currentEnemy.level*10,p=e.currentEnemy.level*25,v=e.player.experience+p;let $=e.player.level,O=e.player.experienceToLevel,w=e.player.maxHealth,R=e.player.health;return s.push(`You defeated ${e.currentEnemy.name} and earned ${d} gold and ${p} XP!`),v>=e.player.experienceToLevel&&($+=1,O=Math.floor(e.player.experienceToLevel*1.5),w=e.player.maxHealth+20,R=w,s.push(`Level Up! You are now level ${$}!`),s.push(`Your max health increased to ${w}!`)),{...e,inCombat:!1,currentEnemy:void 0,combatLog:[],player:{...e.player,level:$,experience:v%O,experienceToLevel:O,maxHealth:w,health:R,gold:e.player.gold+d,stamina:u,combatAbilities:l}}}let f=Math.floor(Math.random()*e.currentEnemy.maxDamage),m=h;const y=e.currentEnemy.statusEffects.filter(d=>new Date<new Date(d.endTime)?(d.damage&&(m=Math.max(0,m-d.damage),s.push(`${e.currentEnemy.name} takes ${d.damage} damage from ${d.type}!`)),!0):(s.push(`${d.type} effect on ${e.currentEnemy.name} has worn off.`),!1));return{...e,currentEnemy:{...e.currentEnemy,health:m,statusEffects:y},player:{...e.player,stamina:u,combatAbilities:l,health:Math.max(0,e.player.health-f)},combatLog:[...e.combatLog,...s].slice(-5)}},attack:e=>{if(!e.currentEnemy)return e;const n=[...e.combatLog],r=5+e.player.strength,s=Math.max(1,r-e.currentEnemy.defense),o=Math.max(0,e.currentEnemy.health-s);if(n.push(`You deal ${s} damage to ${e.currentEnemy.name}!`),o<=0){const u=e.currentEnemy.level*10,f=e.currentEnemy.level*25,m=e.player.experience+f;let y=e.player.level,d=e.player.experienceToLevel,p=e.player.maxHealth,v=e.player.health;return n.push(`You defeated ${e.currentEnemy.name} and earned ${u} gold and ${f} XP!`),m>=e.player.experienceToLevel&&(y+=1,d=Math.floor(e.player.experienceToLevel*1.5),p=e.player.maxHealth+20,v=p,n.push(`Level Up! You are now level ${y}!`),n.push(`Your max health increased to ${p}!`)),{...e,inCombat:!1,currentEnemy:void 0,combatLog:[],player:{...e.player,level:y,experience:m%d,experienceToLevel:d,maxHealth:p,health:v,gold:e.player.gold+u}}}let c=Math.floor(Math.random()*e.currentEnemy.maxDamage),h=o;const l=e.currentEnemy.statusEffects.filter(u=>new Date<new Date(u.endTime)?(u.damage&&(h=Math.max(0,h-u.damage),n.push(`${e.currentEnemy.name} takes ${u.damage} damage from ${u.type}!`)),!0):(n.push(`${u.type} effect on ${e.currentEnemy.name} has worn off.`),!1));return{...e,currentEnemy:{...e.currentEnemy,health:h,statusEffects:l},player:{...e.player,health:Math.max(0,e.player.health-c)},combatLog:[...e.combatLog,...n].slice(-5)}},defend:e=>{if(!e.currentEnemy)return e;const n=[...e.combatLog],r=Math.floor(Math.random()*e.currentEnemy.maxDamage*.5);return n.push(`You defend against ${e.currentEnemy.name}'s attack!`),n.push(`${e.currentEnemy.name} deals ${r} damage to you!`),{...e,player:{...e.player,health:Math.max(0,e.player.health-r)},combatLog:[...e.combatLog,...n].slice(-5)}},useItem:(e,n)=>{if(n==="Health Potion"){const s=Math.min(e.player.maxHealth,e.player.health+30);return{...e,player:{...e.player,health:s,inventory:{...e.player.inventory,consumables:e.player.inventory.consumables.filter(o=>o!==n)}},combatLog:[...e.combatLog,"You used a Health Potion and healed 30 health!"]}}return e},flee:e=>({...e,inCombat:!1,currentEnemy:void 0,combatLog:[]}),acceptQuest:(e,n)=>({...e,player:{...e.player,activeQuests:[...e.player.activeQuests,n]},availableQuests:e.availableQuests.filter(r=>r!==n)})})}componentDidMount(){this.fetchCraftingStations()}async fetchCraftingStations(){try{const e=await fetch("/crafting-stations");if(e.ok){const n=await e.json();a.run("setCraftingStations",n)}}catch(e){console.error("Failed to fetch crafting stations:",e)}}}const j=document.getElementById("app");if(j)try{const i=new le;i.mount(j),a.start(j,i.state,i.view,i.update)}catch(i){console.error("Error initializing game:",i)}
